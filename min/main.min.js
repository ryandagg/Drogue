var GameSpace=function(){var t=function(t){return"#column-"+String(t[0])+"-row-"+String(t[1])},a=function(t){$("#messages").append("<p>"+t+"</p>")},e=function(t,a){return p.map[f.y+a][f.x+t].impassable},s=function(t){if(108===t){var s=1,o=0;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(104===t){var s=-1,o=0;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(106===t){var s=0,o=1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(107===t){var s=0,o=-1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(117===t){var s=1,o=-1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(121===t){var s=-1,o=-1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(110===t){var s=1,o=1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}else if(98===t){var s=-1,o=1;e(s,o)?a("You shall not pass!"):p.updateRogue(s,o)}},o=function(a,e){this.rows=e,this.columns=a,this.map=[],this.tileMatrixGenerator=function(){for(var t=0;t<this.rows;t++){for(var a=[],e=0;e<this.columns;e++)a.push(new n([e,t]));this.map.push(a)}},this.createMap=function(){this.tileMatrixGenerator()},this.createTerrain=function(){for(var t=0;t<this.map.length;t++)for(var a=0;a<this.map[0].length;a++)0===t||t===this.rows-1?this.map[t][a]=new l([t,a]):(0===a||a===this.columns-1)&&(this.map[t][a]=new l(t,a))},this.placeMonsters=function(){for(;10>i;){var t=Math.floor(Math.random()*p.rows),a=Math.floor(Math.random()*p.columns),e=new u;"dot"===p.map[t][a].class&&(p.map[t][a]=e,i++)}},this.placeCharacter=function(){this.map[f.y][f.x]=f},this.updateDisplay=function(a,e){$(t(a.location())).text(a.text),$(t(e.location())).text(e.text),$(t(e.location())).addClass(e.class),$(t(a.location())).addClass(a.class),$(t(a.location())).removeClass(e.class),$(t(e.location())).removeClass(a.class)},this.updateRogue=function(t,a){var e=new n(f.x,f.y);console.log(e.location()),f.x+=t,f.y+=a,this.map[f.y][f.x]=f,this.map[f.y-a][f.x-t]=e,console.log(f.location()),this.updateDisplay(f,e)},this.drawMap=function(){$("#game-window").empty();var t=$("#game-window-template").html(),a=Handlebars.compile(t),e=this,s=0;Handlebars.registerHelper("columnCounter",function(){return s%e.columns}),Handlebars.registerHelper("rowCounter",function(){return s++,Math.floor(s/e.columns)}),$("#game-window").append(a(e))}},n=function(t,a){this.x=t,this.y=a,this.text=".",this.class="dot",this.impassable=!1};n.prototype.location=function(){return[this.x,this.y]};var r=function(){};r.prototype=new n,r.prototype.constructor=r;var l=function(t){n.call(this,t),this.text="#",this.class="wall",this.impassable=!0};l.prototype=new r,l.prototype.constructor=l;var h=function(){this.text="@",this.class="character",this.x=Math.floor(p.columns/2),this.y=Math.floor(p.rows/2),this.health=100,this.attack=100,this.defense=100,this.damage=100,this.location=function(){return[this.x,this.y]}},c=function(){this.healthBase=100,this.attackBase=100,this.damageBase=100,this.defenseBase=100};c.prototype.attack=function(){};var u=function(){this.class="yeek",this.text="y",this.health=this.healthBase/10,this.attack=this.attackBase/10,this.defense=this.defenseBase/10,this.damage=this.damageBase/10,this.treasureQuality=1};u.prototype=new c,u.prototype.constructor=u;var p=new o(60,40),f=new h,m=function(){p.createMap(),p.createTerrain(),p.placeCharacter(),p.placeMonsters,p.drawMap()};return{initialize:m,rogue:f,keyHandler:s}}();$(document).on("ready",function(){GameSpace.initialize(),$(document).keypress(function(t){GameSpace.keyHandler(t.charCode)})});